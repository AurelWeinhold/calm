---
# This playbook prepares the servers for the bootstrap


- name: Setup to bootstrap
  hosts: baremetal
  

  tasks:
      - name: Uninstall old virtual env
        become: yes
        file:
          state: absent
          path: /opt/calm/calmenv
      
      - name: Install apt dependencies
        become: yes
        apt:
            update_cache: yes
            pkg:
                - python3
                - python3-pip
                - python3-dev
                - libffi-dev
                - gcc
                - libssl-dev

      - name: Uninstall docker-py
        pip:
            name: docker-py
            state: absent

      - name: Install pip dependencies
        pip:
            name: docker
            state: latest
